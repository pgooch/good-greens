{"ast":null,"code":"import _objectSpread from \"/Users/phillip/Development/vhosts/playground.develop/good-green/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/phillip/Development/vhosts/playground.develop/good-green/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/phillip/Development/vhosts/playground.develop/good-green/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/phillip/Development/vhosts/playground.develop/good-green/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/phillip/Development/vhosts/playground.develop/good-green/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/phillip/Development/vhosts/playground.develop/good-green/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/phillip/Development/vhosts/playground.develop/good-green/src/components/naughty-list/index.js\";\nimport React, { Component } from 'react';\nimport { Container, Row, Col } from 'reactstrap'; // import { push } from 'connected-react-router'\n// import { bindActionCreators } from 'redux'\n// import { connect } from 'react-redux'\n// import ReactTable from \"react-table\";\n// Components\n\nvar NaughtyList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(NaughtyList, _Component);\n\n  function NaughtyList(props) {\n    var _this;\n\n    _classCallCheck(this, NaughtyList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NaughtyList).call(this, props));\n\n    _this.getLicenseDetails = function (licNum) {\n      var licDetailsCall = ['https://data.lcb.wa.gov/resource/bhbp-x4eb.json?'];\n      licDetailsCall.push('$where=license = \"' + licNum + '\" ');\n      fetch(licDetailsCall.join('')).then(function (response) {\n        return response.json();\n      }).then(_this.storeLicenseDetails);\n    };\n\n    _this.storeLicenseDetails = function (data) {\n      if (data[0] != undefined) {\n        var tempState = _this.state;\n        tempState.violators[data[0].license] = _objectSpread({}, _this.state.violators[data[0].license], data[0]);\n\n        _this.setState(tempState);\n      }\n    };\n\n    _this.getNaughty = function () {\n      var naughtyCall = ['https://data.lcb.wa.gov/resource/dgm4-3cm6.json?'];\n      naughtyCall.push('$select=license_number,wac_code,case,violation_type');\n      fetch(naughtyCall.join('')).then(function (response) {\n        return response.json();\n      }).then(_this.calculateNaughtiness);\n    };\n\n    _this.calculateNaughtiness = function (data) {\n      var tempState = _this.state;\n      data.forEach(function (violation) {\n        // If the violator is not in the object yet add it\n        if (tempState.violators[violation.license_number] === undefined) {\n          tempState.violators[violation.license_number] = {\n            'violationBreakdown': {\n              '_total': 0\n            }\n          };\n\n          _this.getLicenseDetails(violation.license_number);\n        } // Add the violations details to the violationBreakdown\n\n\n        tempState.violators[violation.license_number].violationBreakdown._total++;\n\n        if (tempState.violators[violation.license_number].violationBreakdown[violation.wac_code] === undefined) {\n          tempState.violators[violation.license_number].violationBreakdown[violation.wac_code] = 0;\n        }\n\n        tempState.violators[violation.license_number].violationBreakdown[violation.wac_code]++; // This is going to store the wac codes, that we we know what the numbers actually mean (probably will not be seen)\n\n        if (tempState.wacCodes[violation.wac_code] === undefined) {\n          tempState.wacCodes[violation.wac_code] = violation.violation_type;\n        } // case: \"7M5222A\"\n        // license_number: \"413288\"\n        // violation_type: \"(MJ) Failure to utilize and/or maintain traceability (processor or retail licensee).\"\n        // wac_code: \"314.55.083(4)\"\n        // \t\t\tconsole.log(violation)\n\n      }); // This will greate a large properly formatted data object ready for the state\n      // data.forEach((violation)=>{\n      // if(tempState.violators[violation.license_number]===undefined){\n      // tempState.violators[violation.license_number] = {'license_number':violation.license_number,'violations':{}}\n      // }\n      // if(tempState.violators[violation.license_number].violations[violation.wac_code]===undefined){\n      // tempState.violators[violation.license_number].violations[violation.wac_code] = {'wac_code':violation.wac_code,'violation_description':violation.violation_type,'cases':[]}\n      // }\n      // tempState.violators[violation.license_number].totalViolations++\n      // tempState.violators[violation.license_number].violations[violation.wac_code].cases.push(violation.case)\n      // })\n      // let sortedViolators = Object.keys(tempState.violators).sort((a,b)=>{\n      // \ttempState.violators[violation.license_number].\n      // \tconsole.log('sort',a,b)\n      // })\n      // well, almost ready, gotta sort that to see who is the worst of all\n      // let tempSortArr = []\n      // Object.keys(tempState.violators).forEach((violator)=>{\n      // \ttempSortArr.push(tempState.violators[violator].totalViolations+'.'+violator)\n      // })\n      // tempSortArr.sort();\n      // console.log('tempSortArr',tempSortArr)\n\n      console.log('calculateNaughtiness', tempState); // {case: \"7N6302A\", license_number: \"412199\", violation_type: \"(MJ) Operating plan: Violations of a board-approved operating plan.\", wac_code: \"314.55.020\"}\n    };\n\n    _this.state = {\n      violators: {},\n      wacCodes: {} // Loop through all the licenses and grab the details we need\n\n    };\n\n    _this.getNaughty();\n\n    return _this;\n  } // This will grab the basic license information for the procided license number\n\n\n  _createClass(NaughtyList, [{\n    key: \"render\",\n    value: function render() {\n      var detailID = this.state.displayedLicense;\n      return React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, \"This is the naughty page, its kinda mess at the moment\")), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(\"pre\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, JSON.stringify(this.state, null, 2)))));\n    }\n  }]);\n\n  return NaughtyList;\n}(Component);\n\nexport default NaughtyList; // This is usefull for debugging and just seeing whats going on\n// <","map":{"version":3,"sources":["/Users/phillip/Development/vhosts/playground.develop/good-green/src/components/naughty-list/index.js"],"names":["React","Component","Container","Row","Col","NaughtyList","props","getLicenseDetails","licNum","licDetailsCall","push","fetch","join","then","response","json","storeLicenseDetails","data","undefined","tempState","state","violators","license","setState","getNaughty","naughtyCall","calculateNaughtiness","forEach","violation","license_number","violationBreakdown","_total","wac_code","wacCodes","violation_type","console","log","detailID","displayedLicense","JSON","stringify"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Container, Row, Col } from 'reactstrap';\n// import { push } from 'connected-react-router'\n// import { bindActionCreators } from 'redux'\n// import { connect } from 'react-redux'\n// import ReactTable from \"react-table\";\n\n// Components\n\nclass NaughtyList extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tviolators: {},\n\t\t\twacCodes: {}\n\t\t}\n\t\t// Loop through all the licenses and grab the details we need\n\t\tthis.getNaughty();\n\t}\n\n\t// This will grab the basic license information for the procided license number\n\tgetLicenseDetails = (licNum) => {\n\t\tlet licDetailsCall = ['https://data.lcb.wa.gov/resource/bhbp-x4eb.json?'];\n\t\tlicDetailsCall.push('$where=license = \"'+licNum+'\" ')\n\t\tfetch(licDetailsCall.join('')).then(response => response.json()).then(this.storeLicenseDetails)\n\t}\n\t// Simply saves above\n\tstoreLicenseDetails = (data) => {\n\t\tif(data[0]!=undefined){\n\t\t\tlet tempState = this.state\n\t\t\ttempState.violators[data[0].license] = {...this.state.violators[data[0].license],...data[0]}\n\t\t\tthis.setState(tempState);\n\t\t}\n\t}\n\n\t// This will look for other licenses that may have the same organization name, so we can give the option to combine.\n\tgetNaughty = () => {\n\t\tlet naughtyCall = ['https://data.lcb.wa.gov/resource/dgm4-3cm6.json?']\n\t\tnaughtyCall.push('$select=license_number,wac_code,case,violation_type');\n\t\tfetch(naughtyCall.join('')).then(response => response.json()).then(this.calculateNaughtiness)\n\t}\n\n\tcalculateNaughtiness = (data) => {\n\t\tlet tempState = this.state\n\n\t\tdata.forEach((violation)=>{\n\n\t\t\t// If the violator is not in the object yet add it\n\t\t\tif(tempState.violators[violation.license_number]===undefined){\n\t\t\t\ttempState.violators[violation.license_number] = {'violationBreakdown':{'_total':0}}\n\t\t\t\tthis.getLicenseDetails(violation.license_number);\n\t\t\t}\n\n\t\t\t// Add the violations details to the violationBreakdown\n\t\t\ttempState.violators[violation.license_number].violationBreakdown._total++;\n\t\t\tif(tempState.violators[violation.license_number].violationBreakdown[violation.wac_code]===undefined){\n\t\t\t\ttempState.violators[violation.license_number].violationBreakdown[violation.wac_code] = 0;\n\t\t\t}\n\t\t\ttempState.violators[violation.license_number].violationBreakdown[violation.wac_code]++;\n\n\t\t\t// This is going to store the wac codes, that we we know what the numbers actually mean (probably will not be seen)\n\t\t\tif(tempState.wacCodes[violation.wac_code]===undefined){\n\t\t\t\ttempState.wacCodes[violation.wac_code] = violation.violation_type\n\t\t\t}\n\n// case: \"7M5222A\"\n// license_number: \"413288\"\n// violation_type: \"(MJ) Failure to utilize and/or maintain traceability (processor or retail licensee).\"\n// wac_code: \"314.55.083(4)\"\n\n\n// \t\t\tconsole.log(violation)\n\n\t\t})\n\n\t\t// This will greate a large properly formatted data object ready for the state\n\t\t// data.forEach((violation)=>{\n\t\t\t// if(tempState.violators[violation.license_number]===undefined){\n\t\t\t\t// tempState.violators[violation.license_number] = {'license_number':violation.license_number,'violations':{}}\n\t\t\t// }\n\t\t\t// if(tempState.violators[violation.license_number].violations[violation.wac_code]===undefined){\n\t\t\t\t// tempState.violators[violation.license_number].violations[violation.wac_code] = {'wac_code':violation.wac_code,'violation_description':violation.violation_type,'cases':[]}\n\t\t\t// }\n\t\t\t// tempState.violators[violation.license_number].totalViolations++\n\t\t\t// tempState.violators[violation.license_number].violations[violation.wac_code].cases.push(violation.case)\n\t\t// })\n\n\t\t// let sortedViolators = Object.keys(tempState.violators).sort((a,b)=>{\n\t\t// \ttempState.violators[violation.license_number].\n\t\t// \tconsole.log('sort',a,b)\n\t\t// })\n\n\t\t// well, almost ready, gotta sort that to see who is the worst of all\n\t\t// let tempSortArr = []\n\t\t// Object.keys(tempState.violators).forEach((violator)=>{\n\t\t// \ttempSortArr.push(tempState.violators[violator].totalViolations+'.'+violator)\n\t\t// })\n\t\t// tempSortArr.sort();\n\t\t// console.log('tempSortArr',tempSortArr)\n\t\tconsole.log('calculateNaughtiness',tempState)\n\n\n\n\t\t// {case: \"7N6302A\", license_number: \"412199\", violation_type: \"(MJ) Operating plan: Violations of a board-approved operating plan.\", wac_code: \"314.55.020\"}\n\t}\n\n\trender(){ \n\t\tlet detailID = this.state.displayedLicense;\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>This is the naughty page, its kinda mess at the moment</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<pre>{JSON.stringify(this.state,null,2)}</pre>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</Container>\n\t\t)\n\t}\n}\n\nexport default NaughtyList;\n\n// This is usefull for debugging and just seeing whats going on\n// <"]},"metadata":{},"sourceType":"module"}